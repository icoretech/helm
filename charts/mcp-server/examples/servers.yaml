# Example values file showcasing multiple server styles.
# Most fields below are optional and shown for demonstration.
servers:
  # Native Node server with extra replicas/env/resources and register override
  - name: node-everything
    replicas: 2                 # optional (default 1)
    node:
      package: "@modelcontextprotocol/server-everything"   # required for Node servers
      version: "latest"                                    # optional (default latest)
      tag: 24-alpine                                        # optional (default 24-alpine)
      args: ["streamableHttp"]                             # optional (matches defaults here)
    env:                                  # optional env vars
      - name: NODE_ENV
        value: production
    resources:                            # optional resource requests/limits
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 250m
        memory: 256Mi
    register:                             # optional: override default /gateway/<name>
      prefix: "/gateway/everything"
      headers:
        X-Env: prod

  # Python server using uv with a cache PVC and custom service account
  - name: python-fastmcp
    serviceAccountName: mcp-python        # optional
    python:
      package: mcp-server                 # required
      args: ["--transport","streamable-http","--host","0.0.0.0","--port","3000"]
    # Optional: fetch data before start
    extraVolumes:
      - name: models
        emptyDir: {}
    extraVolumeMounts:
      - name: models
        mountPath: /models
    initContainers:
      - name: fetch-model
        image: alpine:3.20
        command: ["sh","-lc"]
        args:
          - apk add --no-cache curl >/dev/null; \
            curl -fsSL https://example.com/model.bin -o /models/model.bin
        volumeMounts:
          - name: models
            mountPath: /models
    # Optional: mount a per-server config file and point the app to it
    config:
      enabled: true
      filename: config.toml
      mountPath: /config
      contents: |
        # demo config consumed by your app (example format)
        [server]
        message = "Hello from mounted config"
    env:
      - name: FASTMCP_CONFIG              # your app can read this path
        value: /config/config.toml
    cache:                                # optional dependency cache
      enabled: true
      mountPath: /cache
      pvc:
        size: 2Gi
        accessModes: [ReadWriteOnce]

  # Stdio-only server bridged to SSE (serverCommand omitted â†’ derived from python.package)
  - name: stdio-reddit
    python:
      package: mcp-server-reddit
    stdioBridge:
      enabled: true
      # passEnvironment: true            # optional (default true)
      # proxyArgs: ["--sse-path","/events"]        # optional extra bridge flags

  # Custom container image with volumes/tolerations/affinity
  - name: custom-image
    image:
      repository: ghcr.io/example/mcp-custom-server   # required when using image mode
      tag: v1.2.3
      command: ["/app/server"]
      args: ["--port","3000"]
    # Mount a config file and pass its path via args/env if your image supports it
    config:
      enabled: true
      filename: server.yaml
      mountPath: /etc/mcp
      contents: |
        logging:
          level: info
    env:
      - name: MCP_CONFIG
        value: /etc/mcp/server.yaml
    extraVolumeMounts:
      - name: config
        mountPath: /config
    extraVolumes:
      - name: config
        configMap:
          name: mcp-custom-config
    tolerations:
      - key: "node-role.kubernetes.io/spot"
        operator: "Exists"
        effect: "NoSchedule"
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 100
            podAffinityTerm:
              labelSelector:
                matchLabels:
                  app.kubernetes.io/component: server
              topologyKey: kubernetes.io/hostname

  # OpenAPI registration (no Deployment created)
  - name: petstore
    openapi:
      url: "https://petstore3.swagger.io/api/v3/openapi.json"

unla:
  dashboard:
    SUPER_ADMIN_USERNAME: "admin"
    SUPER_ADMIN_PASSWORD: "changeME123"
